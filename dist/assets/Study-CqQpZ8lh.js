import{_ as F,j as v,c as i,k as N,y as V,h as j,a as o,d as y,b as s,t as a,F as k,m as w,n as b,D as M,s as g,A as q,o as l}from"./index-DYN_J6N2.js";import{u as U}from"./study-CUwUs_JI.js";import{a as X,u as J}from"./card-DfiZIG2I.js";const K={class:"study-container"},O={key:0,class:"start-study"},Q={class:"study-options"},W={class:"deck-options"},Y=["onClick"],Z={class:"deck-stats"},ss={key:1,class:"study-completed"},es={class:"session-summary"},ts={class:"progress-bar"},as={key:2,class:"flashcard-study"},ns={class:"progress-indicator"},os={class:"flashcard-inner"},ls=["innerHTML"],rs=["innerHTML"],ds={class:"rating-buttons"},us=["onClick"],is={class:"card-tags"},cs={class:"reward-content"},vs={class:"reward-xp"},ps={__name:"Study",setup(ms){const L=V(),P=q(),n=U();X();const $=J(),_=v(!1),d=i(()=>n.currentSession),p=i(()=>n.getCurrentCard()),x=i(()=>n.dueCards),I=i(()=>$.allDecks),R=i(()=>n.todayLearned),S=i(()=>n.todayProgress),D=i(()=>n.dailyGoal),T=[{value:0,label:"å®Œå…¨ä¸è®°å¾—"},{value:1,label:"ä¸è®°å¾—"},{value:2,label:"æœ‰ç‚¹è®°å¾—"},{value:3,label:"è®°å¾—ä½†æœ‰å›°éš¾"},{value:4,label:"è®°å¾—"},{value:5,label:"å®Œå…¨è®°å¾—"}];let m=v("");N(()=>{const r=L.params.deckId;r&&h(r)});function h(r=null){const e=n.startStudySession(r);_.value=!0,e===0&&(d.value.completed=!0)}function H(){n.showAnswer()}function z(){n.resetSession(),_.value=!1,P.push("/study")}function B(){m.value=`https://api.mtyqx.cn/api/random.php?t=${Date.now()}`,console.log(m)}const u=j(),c=v(!1),C=v(""),A=v(0);function G(r){if(n.answerCard(r),r>=3){u.addPoints(10,"æ­£ç¡®å›ç­”å¡ç‰‡"),u.updateStreak();const e=n.studyStats.totalReviews;if(e===1?u.unlockAchievement("first_review","åˆæ¬¡å¤ä¹ ","å®Œæˆé¦–æ¬¡å¡ç‰‡å¤ä¹ "):e===10?(u.unlockAchievement("review_10","å¤ä¹ å…¥é—¨","å¤ä¹ 10å¼ å¡ç‰‡"),f("æˆå°±è§£é”: å¤ä¹ å…¥é—¨",50)):e===100?(u.unlockAchievement("review_100","å¤ä¹ ä¸“å®¶","å¤ä¹ 100å¼ å¡ç‰‡"),f("æˆå°±è§£é”: å¤ä¹ ä¸“å®¶",100)):e===1e3&&(u.unlockAchievement("review_1000","å¤ä¹ å¤§å¸ˆ","å¤ä¹ 1000å¼ å¡ç‰‡"),f("æˆå°±è§£é”: å¤ä¹ å¤§å¸ˆ",200)),Math.random()<.2){const t=Math.floor(Math.random()*10)+5;f("è¿ç»­æ­£ç¡®å›ç­”ï¼Œè·å¾—é¢å¤–å¥–åŠ±ï¼",t)}}else u.addPoints(3,"å­¦ä¹ å°è¯•");d.value.completed&&u.addPoints(20,"å®Œæˆå­¦ä¹ ä¼šè¯")}function f(r,e){C.value=r,A.value=e,c.value=!0,u.addExperience(e),setTimeout(()=>{c.value=!1},3e3)}return(r,e)=>(l(),o("div",K,[!d.value.cards.length&&!_.value?(l(),o("div",O,[e[5]||(e[5]=s("h2",null,"å¼€å§‹å­¦ä¹ ",-1)),s("div",Q,[s("div",{class:"study-option",onClick:e[0]||(e[0]=t=>h())},[e[3]||(e[3]=s("h3",null,"å­¦ä¹ æ‰€æœ‰å¾…å¤ä¹ å¡ç‰‡",-1)),s("p",null,"ä»Šæ—¥å¾…å¤ä¹ : "+a(x.value.length)+" å¼ å¡ç‰‡",1)]),s("div",W,[e[4]||(e[4]=s("h3",null,"é€‰æ‹©å¡ç‰‡é›†å­¦ä¹ ",-1)),(l(!0),o(k,null,w(I.value,t=>(l(),o("div",{key:t.id,class:"deck-option",onClick:E=>h(t.id)},[s("h4",null,a(t.title),1),s("p",null,a(t.description),1),s("div",Z," å…± "+a(t.cardsCount)+" å¼ å¡ç‰‡ ",1)],8,Y))),128))])])])):d.value.completed?(l(),o("div",ss,[e[6]||(e[6]=s("h2",null,"å­¦ä¹ å®Œæˆ!",-1)),s("div",es,[s("p",null,"æœ¬æ¬¡å­¦ä¹ äº† "+a(d.value.cards.length)+" å¼ å¡ç‰‡",1),s("div",ts,[s("div",{class:"progress-bar-inner",style:b({width:S.value+"%"})},null,4)]),s("p",null,"ä»Šæ—¥è¿›åº¦: "+a(R.value)+" / "+a(D.value)+" ("+a(S.value)+"%)",1)]),s("button",{class:"primary-button",onClick:z},"ç»§ç»­å­¦ä¹ ")])):p.value?(l(),o("div",as,[s("div",ns,a(d.value.currentIndex+1)+" / "+a(d.value.cards.length),1),s("div",{class:g(["flashcard",{flipped:d.value.showAnswer}])},[s("div",os,[s("div",{class:"flashcard-front",style:b({backgroundImage:`url(${M(m)})`})},[s("div",{class:"card-content",innerHTML:p.value.front},null,8,ls),d.value.showAnswer?y("",!0):(l(),o("button",{key:0,class:"show-answer-btn",onClick:e[1]||(e[1]=t=>(H(),B()))}," æ˜¾ç¤ºç­”æ¡ˆ "))],4),s("div",{class:"flashcard-back",style:b({backgroundImage:`url(${M(m)})`})},[s("div",{class:"card-content",innerHTML:p.value.back},null,8,rs),s("div",ds,[(l(),o(k,null,w(T,t=>s("button",{key:t.value,class:g(["rating-btn","rating-"+t.value]),onClick:E=>G(t.value)},a(t.label),11,us)),64))])],4)])],2),s("div",is,[(l(!0),o(k,null,w(p.value.tags,t=>(l(),o("span",{key:t,class:"tag"},a(t),1))),128))])])):y("",!0),c.value?(l(),o("div",{key:3,class:g(["reward-popup",{active:c.value}])},[s("div",cs,[e[7]||(e[7]=s("div",{class:"reward-icon"},"ğŸ‰",-1)),e[8]||(e[8]=s("h3",null,"è·å¾—å¥–åŠ±ï¼",-1)),s("p",null,a(C.value),1),s("div",vs,"+"+a(A.value)+" XP",1),s("button",{class:"reward-close-btn",onClick:e[2]||(e[2]=t=>c.value=!1)},"ç»§ç»­å­¦ä¹ ")])],2)):y("",!0)]))}},ys=F(ps,[["__scopeId","data-v-b9d87433"]]);export{ys as default};
