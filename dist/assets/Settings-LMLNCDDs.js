import{_ as R,u as V,j as u,bx as T,k as F,a as h,b as t,d as J,l as g,v as f,by as B,t as x,q as G,s as L,A,o as w}from"./index-DYN_J6N2.js";import{u as $}from"./study-CUwUs_JI.js";import{a as q,u as H}from"./card-DfiZIG2I.js";const K={class:"settings-container"},Q={class:"settings-card"},W={class:"settings-section"},X={class:"setting-item"},Y={class:"setting-control"},Z={class:"setting-item"},tt={class:"setting-control"},et={class:"settings-section"},st={class:"setting-item"},nt={class:"setting-control"},lt={class:"setting-item"},it={class:"setting-control"},ot={class:"setting-item"},at={class:"setting-control"},dt={class:"settings-section"},rt={class:"setting-item"},ct={class:"setting-control"},ut={class:"toggle-switch"},gt={class:"setting-item"},vt={class:"setting-control"},mt={class:"range-with-value"},pt={class:"range-value"},ft={class:"settings-section"},bt={class:"setting-item"},St={class:"setting-control"},yt={class:"modal-content"},kt={class:"modal-header"},Ct={class:"modal-body"},xt={class:"form-actions"},_t={__name:"Settings",setup(Dt){const _=A(),S=$(),o=q(),b=H(),y=V(),k=u(null),a=u(!1),v=u(""),m=u(""),d=u(()=>{}),p=u("default"),s=T({username:y.username||"用户",email:"",dailyGoal:S.dailyGoal,newCardsPerDay:20,reminderTime:"08:00",darkMode:localStorage.getItem("theme")==="dark",fontSize:parseInt(localStorage.getItem("fontSize")||"16")}),C=u({});F(()=>{C.value={...s};const l=localStorage.getItem("userSettings");if(l){const e=JSON.parse(l);Object.assign(s,e)}});function D(){const l=s.darkMode;document.documentElement.classList.toggle("dark-theme",l),localStorage.setItem("theme",l?"dark":"light")}function I(){document.documentElement.style.fontSize=`${s.fontSize}px`,localStorage.setItem("fontSize",s.fontSize.toString())}function z(){S.setDailyGoal(s.dailyGoal),localStorage.setItem("userSettings",JSON.stringify(s)),y.setUser({...y.user,username:s.username}),a.value=!0,v.value="设置已保存",m.value="您的设置已成功保存",d.value=i,p.value="default",C.value={...s}}function O(){Object.assign(s,C.value),s.darkMode!==(localStorage.getItem("theme")==="dark")&&D();const l=parseInt(localStorage.getItem("fontSize")||"16");s.fontSize!==l&&I()}function U(){const l={decks:b.allDecks,cards:o.allCards,cardsProgress:o.cardsProgress,studyStats:S.studyStats,settings:s,exportDate:new Date().toISOString()},e=new Blob([JSON.stringify(l,null,2)],{type:"application/json"}),n=URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download=`flashcards-export-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n),a.value=!0,v.value="导出成功",m.value="您的数据已成功导出",d.value=i,p.value="default"}function P(){k.value.click()}function M(l){const e=l.target.files[0];if(!e)return;const n=new FileReader;n.onload=r=>{try{const c=JSON.parse(r.target.result);if(!c.decks||!c.cards)throw new Error("无效的导入文件格式");a.value=!0,v.value="确认导入",m.value=`导入将添加 ${c.decks.length} 个卡片集和 ${c.cards.length} 张卡片。继续吗？`,d.value=()=>j(c),p.value="default"}catch(c){alert("导入失败: "+c.message)}k.value.value=""},n.readAsText(e)}function j(l){try{l.decks.forEach(e=>{b.getDeckById(e.id)?b.updateDeck(e.id,e):b.addDeck(e)}),l.cards.forEach(e=>{o.getCardById(e.id)?o.updateCard(e.id,e):o.addCard(e)}),l.cardsProgress&&Object.keys(l.cardsProgress).forEach(e=>{o.updateCardProgress(e,l.cardsProgress[e])}),i(),a.value=!0,v.value="导入成功",m.value="数据已成功导入",d.value=()=>{i(),_.go(0)},p.value="default"}catch(e){alert("导入数据时出错: "+e.message),i()}}function E(){a.value=!0,v.value="确认重置学习进度",m.value="此操作将清除所有卡片的学习进度和统计数据。此操作不可撤销！",d.value=N,p.value="danger"}function N(){o.allCards.forEach(e=>{o.resetCardProgress(e.id)}),localStorage.setItem("flashcard-study-stats",JSON.stringify({totalReviews:0,correctReviews:0,sessionHistory:[]})),i(),_.go(0)}function i(){a.value=!1}return(l,e)=>(w(),h("div",K,[e[23]||(e[23]=t("h1",null,"设置",-1)),t("div",Q,[t("div",W,[e[10]||(e[10]=t("h2",null,"个人设置",-1)),t("div",X,[e[8]||(e[8]=t("div",{class:"setting-label"},[t("div",{class:"label-text"},"用户名"),t("div",{class:"setting-description"},"显示在应用中的用户名")],-1)),t("div",Y,[g(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=n=>s.username=n)},null,512),[[f,s.username]])])]),t("div",Z,[e[9]||(e[9]=t("div",{class:"setting-label"},[t("div",{class:"label-text"},"邮箱"),t("div",{class:"setting-description"},"用于接收通知和找回密码")],-1)),t("div",tt,[g(t("input",{type:"email","onUpdate:modelValue":e[1]||(e[1]=n=>s.email=n)},null,512),[[f,s.email]])])])]),t("div",et,[e[14]||(e[14]=t("h2",null,"学习设置",-1)),t("div",st,[e[11]||(e[11]=t("div",{class:"setting-label"},[t("div",{class:"label-text"},"每日学习目标"),t("div",{class:"setting-description"},"设置每天要学习的卡片数量")],-1)),t("div",nt,[g(t("input",{type:"number","onUpdate:modelValue":e[2]||(e[2]=n=>s.dailyGoal=n),min:"1",max:"500"},null,512),[[f,s.dailyGoal,void 0,{number:!0}]])])]),t("div",lt,[e[12]||(e[12]=t("div",{class:"setting-label"},[t("div",{class:"label-text"},"新卡片限制"),t("div",{class:"setting-description"},"每天学习的新卡片上限")],-1)),t("div",it,[g(t("input",{type:"number","onUpdate:modelValue":e[3]||(e[3]=n=>s.newCardsPerDay=n),min:"0",max:"200"},null,512),[[f,s.newCardsPerDay,void 0,{number:!0}]])])]),t("div",ot,[e[13]||(e[13]=t("div",{class:"setting-label"},[t("div",{class:"label-text"},"学习提醒"),t("div",{class:"setting-description"},"每天提醒学习的时间")],-1)),t("div",at,[g(t("input",{type:"time","onUpdate:modelValue":e[4]||(e[4]=n=>s.reminderTime=n)},null,512),[[f,s.reminderTime]])])])]),t("div",dt,[e[18]||(e[18]=t("h2",null,"外观设置",-1)),t("div",rt,[e[16]||(e[16]=t("div",{class:"setting-label"},[t("div",{class:"label-text"},"暗黑模式"),t("div",{class:"setting-description"},"切换浅色/深色主题")],-1)),t("div",ct,[t("label",ut,[g(t("input",{type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=n=>s.darkMode=n),onChange:D},null,544),[[B,s.darkMode]]),e[15]||(e[15]=t("span",{class:"toggle-slider"},null,-1))])])]),t("div",gt,[e[17]||(e[17]=t("div",{class:"setting-label"},[t("div",{class:"label-text"},"字体大小"),t("div",{class:"setting-description"},"调整应用中文字的大小")],-1)),t("div",vt,[t("div",mt,[g(t("input",{type:"range","onUpdate:modelValue":e[6]||(e[6]=n=>s.fontSize=n),min:"12",max:"24",step:"1",onChange:I},null,544),[[f,s.fontSize,void 0,{number:!0}]]),t("span",pt,x(s.fontSize)+"px",1)])])])]),t("div",ft,[e[22]||(e[22]=t("h2",null,"数据管理",-1)),t("div",{class:"setting-item"},[e[19]||(e[19]=t("div",{class:"setting-label"},[t("div",{class:"label-text"},"导出数据"),t("div",{class:"setting-description"},"将所有卡片集和卡片导出为JSON文件")],-1)),t("div",{class:"setting-control"},[t("button",{class:"action-btn export-btn",onClick:U},"导出")])]),t("div",bt,[e[20]||(e[20]=t("div",{class:"setting-label"},[t("div",{class:"label-text"},"导入数据"),t("div",{class:"setting-description"},"从JSON文件导入卡片集和卡片")],-1)),t("div",St,[t("input",{type:"file",ref_key:"importFileInput",ref:k,style:{display:"none"},accept:".json",onChange:M},null,544),t("button",{class:"action-btn import-btn",onClick:P},"导入")])]),t("div",{class:"setting-item"},[e[21]||(e[21]=t("div",{class:"setting-label"},[t("div",{class:"label-text"},"重置学习进度"),t("div",{class:"setting-description"},"清除所有卡片的学习记录和统计数据")],-1)),t("div",{class:"setting-control"},[t("button",{class:"action-btn danger-btn",onClick:E},"重置")])])]),t("div",{class:"settings-actions"},[t("button",{class:"cancel-btn",onClick:O},"取消"),t("button",{class:"save-btn",onClick:z},"保存设置")])]),a.value?(w(),h("div",{key:0,class:"modal",onClick:G(i,["self"])},[t("div",yt,[t("div",kt,[t("h2",null,x(v.value),1),t("button",{class:"close-btn",onClick:i},"×")]),t("div",Ct,[t("p",null,x(m.value),1),t("div",xt,[t("button",{class:"cancel-btn",onClick:i},"取消"),t("button",{class:L(["confirm-btn",{"danger-btn":p.value==="danger"}]),onClick:e[7]||(e[7]=(...n)=>d.value&&d.value(...n))}," 确认 ",2)])])])])):J("",!0)]))}},zt=R(_t,[["__scopeId","data-v-b1d20b53"]]);export{zt as default};
